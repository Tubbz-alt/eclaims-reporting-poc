## autogenerated by AWS Glue console
import sys
from awsglue.transforms import *
from awsglue.utils import getResolvedOptions
from pyspark.context import SparkContext
from awsglue.context import GlueContext
from awsglue.job import Job

## @params: [JOB_NAME]
args = getResolvedOptions(sys.argv, ['JOB_NAME'])

sc = SparkContext()
glueContext = GlueContext(sc)
spark = glueContext.spark_session
job = Job(glueContext)
job.init(args['JOB_NAME'], args)
## @type: DataSource
## @args: [database = "mhclg-test-s3-crawler-db", table_name = "xml", transformation_ctx = "datasource0"]
## @return: datasource0
## @inputs: []
datasource0 = glueContext.create_dynamic_frame.from_catalog(database = "mhclg-test-s3-crawler-db", table_name = "xml", transformation_ctx = "datasource0")
## @type: ApplyMapping
## @args: [mapping = [("_approved", "boolean", "_approved", "boolean"), ("_defrayal-check", "boolean", "_defrayal-check", "boolean"), ("_orig-id", "string", "_orig-id", "string"), ("_src", "string", "_src", "string"), ("category-of-region._VALUE", "string", "`category-of-region._VALUE`", "string"), ("category-of-region._id", "string", "`category-of-region._id`", "string"), ("certification._exchange-rate", "double", "`certification._exchange-rate`", "double"), ("certification._status", "string", "`certification._status`", "string"), ("certification.cert-batch._VALUE", "string", "`certification.cert-batch._VALUE`", "string"), ("certification.cert-batch._batch-id", "string", "`certification.cert-batch._batch-id`", "string"), ("certification.cert-batch._batch-ref", "string", "`certification.cert-batch._batch-ref`", "string"), ("certification.cert-batch._batch-status", "string", "`certification.cert-batch._batch-status`", "string"), ("certification.cert-batch._batch-updated", "string", "`certification.cert-batch._batch-updated`", "string"), ("certification.certified-date", "string", "`certification.certified-date`", "string"), ("claim-date", "string", "claim-date", "string"), ("claim-month", "int", "claim-month", "int"), ("claim-period._VALUE", "string", "`claim-period._VALUE`", "string"), ("claim-period._end-date", "string", "`claim-period._end-date`", "string"), ("claim-period._start-date", "string", "`claim-period._start-date`", "string"), ("claim-quarter", "int", "claim-quarter", "int"), ("claim-reference-number", "string", "claim-reference-number", "string"), ("claim-schedule", "string", "claim-schedule", "string"), ("claim-type", "string", "claim-type", "string"), ("claim-year", "int", "claim-year", "int"), ("created-date", "string", "created-date", "string"), ("ec-payment-status", "string", "ec-payment-status", "string"), ("intervention-rate", "int", "intervention-rate", "int"), ("lines.line._VALUE", "double", "`lines.line._VALUE`", "double"), ("lines.line._eligible-cap-expenditure", "int", "`lines.line._eligible-cap-expenditure`", "int"), ("lines.line._eligible-rev-expenditure", "double", "`lines.line._eligible-rev-expenditure`", "double"), ("lines.line._fric-cap", "int", "`lines.line._fric-cap`", "int"), ("lines.line._fric-rev", "double", "`lines.line._fric-rev`", "double"), ("lines.line._frpp-cap", "int", "`lines.line._frpp-cap`", "int"), ("lines.line._frpp-rev", "int", "`lines.line._frpp-rev`", "int"), ("lines.line._fund", "double", "`lines.line._fund`", "double"), ("lines.line._fund-cap-expenditure", "int", "`lines.line._fund-cap-expenditure`", "int"), ("lines.line._fund-cap-intervention-rate", "int", "`lines.line._fund-cap-intervention-rate`", "int"), ("lines.line._fund-rev-expenditure", "double", "`lines.line._fund-rev-expenditure`", "double"), ("lines.line._fund-rev-intervention-rate", "double", "`lines.line._fund-rev-intervention-rate`", "double"), ("lines.line._fund-tot-intervention-rate", "double", "`lines.line._fund-tot-intervention-rate`", "double"), ("lines.line._ip-code", "double", "`lines.line._ip-code`", "double"), ("lines.line._ip-name", "string", "`lines.line._ip-name`", "string"), ("lines.line._pa-name", "string", "`lines.line._pa-name`", "string"), ("lines.line._private-cap-expenditure", "int", "`lines.line._private-cap-expenditure`", "int"), ("lines.line._private-cap-intervention-rate", "int", "`lines.line._private-cap-intervention-rate`", "int"), ("lines.line._private-rev-expenditure", "double", "`lines.line._private-rev-expenditure`", "double"), ("lines.line._private-rev-intervention-rate", "double", "`lines.line._private-rev-intervention-rate`", "double"), ("lines.line._private-tot-intervention-rate", "double", "`lines.line._private-tot-intervention-rate`", "double"), ("lines.line._public", "double", "`lines.line._public`", "double"), ("lines.line._public-cap-expenditure", "int", "`lines.line._public-cap-expenditure`", "int"), ("lines.line._public-cap-intervention-rate", "int", "`lines.line._public-cap-intervention-rate`", "int"), ("lines.line._public-rev-expenditure", "double", "`lines.line._public-rev-expenditure`", "double"), ("lines.line._public-rev-intervention-rate", "double", "`lines.line._public-rev-intervention-rate`", "double"), ("lines.line._public-tot-intervention-rate", "double", "`lines.line._public-tot-intervention-rate`", "double"), ("lines.line._total-cap-expenditure", "int", "`lines.line._total-cap-expenditure`", "int"), ("lines.line._total-rev-expenditure", "double", "`lines.line._total-rev-expenditure`", "double"), ("lines.line._type", "string", "`lines.line._type`", "string"), ("lines.line._yei", "int", "`lines.line._yei`", "int"), ("links.link", "array", "`links.link`", "string"), ("nil-claim", "boolean", "nil-claim", "boolean"), ("offset._VALUE", "string", "`offset._VALUE`", "string"), ("offset._capital", "int", "`offset._capital`", "int"), ("offset._revenue", "int", "`offset._revenue`", "int"), ("offset._total", "int", "`offset._total`", "int"), ("payments.payment._orig-id", "string", "`payments.payment._orig-id`", "string"), ("payments.payment._status", "string", "`payments.payment._status`", "string"), ("payments.payment.instruction-details._VALUE", "string", "`payments.payment.instruction-details._VALUE`", "string"), ("payments.payment.instruction-details._sent-by", "string", "`payments.payment.instruction-details._sent-by`", "string"), ("payments.payment.instruction-details._sent-on", "string", "`payments.payment.instruction-details._sent-on`", "string"), ("payments.payment.payment-date", "string", "`payments.payment.payment-date`", "string"), ("payments.payment.payment-reference", "string", "`payments.payment.payment-reference`", "string"), ("priority-axis", "string", "priority-axis", "string"), ("status", "string", "status", "string"), ("submitted-date", "string", "submitted-date", "string"), ("wf-stages.wf-stage", "array", "`wf-stages.wf-stage`", "string")], transformation_ctx = "applymapping1"]
## @return: applymapping1
## @inputs: [frame = datasource0]
applymapping1 = ApplyMapping.apply(frame = datasource0, mappings = [("_approved", "boolean", "_approved", "boolean"), ("_defrayal-check", "boolean", "_defrayal-check", "boolean"), ("_orig-id", "string", "_orig-id", "string"), ("_src", "string", "_src", "string"), ("category-of-region._VALUE", "string", "`category-of-region._VALUE`", "string"), ("category-of-region._id", "string", "`category-of-region._id`", "string"), ("certification._exchange-rate", "double", "`certification._exchange-rate`", "double"), ("certification._status", "string", "`certification._status`", "string"), ("certification.cert-batch._VALUE", "string", "`certification.cert-batch._VALUE`", "string"), ("certification.cert-batch._batch-id", "string", "`certification.cert-batch._batch-id`", "string"), ("certification.cert-batch._batch-ref", "string", "`certification.cert-batch._batch-ref`", "string"), ("certification.cert-batch._batch-status", "string", "`certification.cert-batch._batch-status`", "string"), ("certification.cert-batch._batch-updated", "string", "`certification.cert-batch._batch-updated`", "string"), ("certification.certified-date", "string", "`certification.certified-date`", "string"), ("claim-date", "string", "claim-date", "string"), ("claim-month", "int", "claim-month", "int"), ("claim-period._VALUE", "string", "`claim-period._VALUE`", "string"), ("claim-period._end-date", "string", "`claim-period._end-date`", "string"), ("claim-period._start-date", "string", "`claim-period._start-date`", "string"), ("claim-quarter", "int", "claim-quarter", "int"), ("claim-reference-number", "string", "claim-reference-number", "string"), ("claim-schedule", "string", "claim-schedule", "string"), ("claim-type", "string", "claim-type", "string"), ("claim-year", "int", "claim-year", "int"), ("created-date", "string", "created-date", "string"), ("ec-payment-status", "string", "ec-payment-status", "string"), ("intervention-rate", "int", "intervention-rate", "int"), ("lines.line._VALUE", "double", "`lines.line._VALUE`", "double"), ("lines.line._eligible-cap-expenditure", "int", "`lines.line._eligible-cap-expenditure`", "int"), ("lines.line._eligible-rev-expenditure", "double", "`lines.line._eligible-rev-expenditure`", "double"), ("lines.line._fric-cap", "int", "`lines.line._fric-cap`", "int"), ("lines.line._fric-rev", "double", "`lines.line._fric-rev`", "double"), ("lines.line._frpp-cap", "int", "`lines.line._frpp-cap`", "int"), ("lines.line._frpp-rev", "int", "`lines.line._frpp-rev`", "int"), ("lines.line._fund", "double", "`lines.line._fund`", "double"), ("lines.line._fund-cap-expenditure", "int", "`lines.line._fund-cap-expenditure`", "int"), ("lines.line._fund-cap-intervention-rate", "int", "`lines.line._fund-cap-intervention-rate`", "int"), ("lines.line._fund-rev-expenditure", "double", "`lines.line._fund-rev-expenditure`", "double"), ("lines.line._fund-rev-intervention-rate", "double", "`lines.line._fund-rev-intervention-rate`", "double"), ("lines.line._fund-tot-intervention-rate", "double", "`lines.line._fund-tot-intervention-rate`", "double"), ("lines.line._ip-code", "double", "`lines.line._ip-code`", "double"), ("lines.line._ip-name", "string", "`lines.line._ip-name`", "string"), ("lines.line._pa-name", "string", "`lines.line._pa-name`", "string"), ("lines.line._private-cap-expenditure", "int", "`lines.line._private-cap-expenditure`", "int"), ("lines.line._private-cap-intervention-rate", "int", "`lines.line._private-cap-intervention-rate`", "int"), ("lines.line._private-rev-expenditure", "double", "`lines.line._private-rev-expenditure`", "double"), ("lines.line._private-rev-intervention-rate", "double", "`lines.line._private-rev-intervention-rate`", "double"), ("lines.line._private-tot-intervention-rate", "double", "`lines.line._private-tot-intervention-rate`", "double"), ("lines.line._public", "double", "`lines.line._public`", "double"), ("lines.line._public-cap-expenditure", "int", "`lines.line._public-cap-expenditure`", "int"), ("lines.line._public-cap-intervention-rate", "int", "`lines.line._public-cap-intervention-rate`", "int"), ("lines.line._public-rev-expenditure", "double", "`lines.line._public-rev-expenditure`", "double"), ("lines.line._public-rev-intervention-rate", "double", "`lines.line._public-rev-intervention-rate`", "double"), ("lines.line._public-tot-intervention-rate", "double", "`lines.line._public-tot-intervention-rate`", "double"), ("lines.line._total-cap-expenditure", "int", "`lines.line._total-cap-expenditure`", "int"), ("lines.line._total-rev-expenditure", "double", "`lines.line._total-rev-expenditure`", "double"), ("lines.line._type", "string", "`lines.line._type`", "string"), ("lines.line._yei", "int", "`lines.line._yei`", "int"), ("links.link", "array", "`links.link`", "string"), ("nil-claim", "boolean", "nil-claim", "boolean"), ("offset._VALUE", "string", "`offset._VALUE`", "string"), ("offset._capital", "int", "`offset._capital`", "int"), ("offset._revenue", "int", "`offset._revenue`", "int"), ("offset._total", "int", "`offset._total`", "int"), ("payments.payment._orig-id", "string", "`payments.payment._orig-id`", "string"), ("payments.payment._status", "string", "`payments.payment._status`", "string"), ("payments.payment.instruction-details._VALUE", "string", "`payments.payment.instruction-details._VALUE`", "string"), ("payments.payment.instruction-details._sent-by", "string", "`payments.payment.instruction-details._sent-by`", "string"), ("payments.payment.instruction-details._sent-on", "string", "`payments.payment.instruction-details._sent-on`", "string"), ("payments.payment.payment-date", "string", "`payments.payment.payment-date`", "string"), ("payments.payment.payment-reference", "string", "`payments.payment.payment-reference`", "string"), ("priority-axis", "string", "priority-axis", "string"), ("status", "string", "status", "string"), ("submitted-date", "string", "submitted-date", "string"), ("wf-stages.wf-stage", "array", "`wf-stages.wf-stage`", "string")], transformation_ctx = "applymapping1")
## @type: ResolveChoice
## @args: [choice = "make_cols", transformation_ctx = "resolvechoice2"]
## @return: resolvechoice2
## @inputs: [frame = applymapping1]
resolvechoice2 = ResolveChoice.apply(frame = applymapping1, choice = "make_cols", transformation_ctx = "resolvechoice2")
## @type: DropNullFields
## @args: [transformation_ctx = "dropnullfields3"]
## @return: dropnullfields3
## @inputs: [frame = resolvechoice2]
dropnullfields3 = DropNullFields.apply(frame = resolvechoice2, transformation_ctx = "dropnullfields3")
## @type: DataSink
## @args: [catalog_connection = "test-glue-rds-connection", connection_options = {"dbtable": "xml", "database": "test_reporting_db"}, transformation_ctx = "datasink4"]
## @return: datasink4
## @inputs: [frame = dropnullfields3]
datasink4 = glueContext.write_dynamic_frame.from_jdbc_conf(frame = dropnullfields3, catalog_connection = "test-glue-rds-connection", connection_options = {"dbtable": "xml", "database": "test_reporting_db"}, transformation_ctx = "datasink4")
job.commit()
